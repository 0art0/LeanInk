[{"tailPos":2076,"headPos":2052,"goalsBefore":["α : Type ?u.599\nn : ℕ\np q : Partition n\n⊢ Decidable (p = q)"],"goalsAfter":["α : Type ?u.599\nn : ℕ\np q : Partition n\n⊢ Decidable (p.parts = q.parts)"],"content":"simp [Partition.ext_iff]"},{"tailPos":2077,"headPos":2076,"goalsBefore":["α : Type ?u.599\nn : ℕ\np q : Partition n\n⊢ Decidable (p.parts = q.parts)"],"goalsAfter":["α : Type ?u.599\nn : ℕ\np q : Partition n\n⊢ Decidable (p.parts = q.parts)"],"content":";"},{"tailPos":2111,"headPos":2078,"goalsBefore":["α : Type ?u.599\nn : ℕ\np q : Partition n\n⊢ Decidable (p.parts = q.parts)"],"goalsAfter":[],"content":"exact decidableEq p.parts q.parts"},{"tailPos":2111,"headPos":2052,"goalsBefore":["α : Type ?u.599\nn : ℕ\np q : Partition n\n⊢ Decidable (p = q)"],"goalsAfter":[],"content":"simp [Partition.ext_iff]; exact decidableEq p.parts q.parts"},{"tailPos":2051,"headPos":2049,"goalsBefore":["α : Type ?u.599\nn : ℕ\np q : Partition n\n⊢ Decidable (p = q)"],"goalsAfter":[],"content":"by"},{"tailPos":2111,"headPos":2049,"goalsBefore":["α : Type ?u.599\nn : ℕ\np q : Partition n\n⊢ Decidable (p = q)"],"goalsAfter":[],"content":"by simp [Partition.ext_iff]; exact decidableEq p.parts q.parts"},{"tailPos":2362,"headPos":2345,"goalsBefore":["α : Type ?u.982\nn : ℕ\nc : Composition n\n⊢ sum ↑c.blocks = n"],"goalsAfter":["α : Type ?u.982\nn : ℕ\nc : Composition n\n⊢ List.sum c.blocks = n"],"content":"Multiset.coe_sum,"},{"tailPos":2375,"headPos":2363,"goalsBefore":["α : Type ?u.982\nn : ℕ\nc : Composition n\n⊢ List.sum c.blocks = n"],"goalsAfter":["α : Type ?u.982\nn : ℕ\nc : Composition n\n⊢ n = n"],"content":"c.blocks_sum"},{"tailPos":2376,"headPos":2375,"goalsBefore":["α : Type ?u.982\nn : ℕ\nc : Composition n\n⊢ n = n"],"goalsAfter":[],"content":"]"},{"tailPos":2376,"headPos":2341,"goalsBefore":["α : Type ?u.982\nn : ℕ\nc : Composition n\n⊢ sum ↑c.blocks = n"],"goalsAfter":[],"content":"rw [Multiset.coe_sum, c.blocks_sum]"},{"tailPos":2340,"headPos":2338,"goalsBefore":["α : Type ?u.982\nn : ℕ\nc : Composition n\n⊢ sum ↑c.blocks = n"],"goalsAfter":[],"content":"by"},{"tailPos":2376,"headPos":2338,"goalsBefore":["α : Type ?u.982\nn : ℕ\nc : Composition n\n⊢ sum ↑c.blocks = n"],"goalsAfter":[],"content":"by rw [Multiset.coe_sum, c.blocks_sum]"},{"tailPos":2555,"headPos":2527,"goalsBefore":["α : Type ?u.1285\nn : ℕ\n⊢ Function.Surjective (ofComposition n)"],"goalsAfter":["case mk\nα : Type ?u.1285\nn : ℕ\nb : Multiset ℕ\nhb₁ : ∀ {i : ℕ}, i ∈ b → 0 < i\nhb₂ : sum b = n\n⊢ ∃ a, ofComposition n a = { parts := b, parts_pos := hb₁, parts_sum := hb₂ }"],"content":"rintro ⟨b, hb₁, hb₂⟩"},{"tailPos":2604,"headPos":2558,"goalsBefore":["case mk\nα : Type ?u.1285\nn : ℕ\nb : Multiset ℕ\nhb₁ : ∀ {i : ℕ}, i ∈ b → 0 < i\nhb₂ : sum b = n\n⊢ ∃ a, ofComposition n a = { parts := b, parts_pos := hb₁, parts_sum := hb₂ }"],"goalsAfter":["case mk.intro\nα : Type ?u.1285\nn : ℕ\nb : List ℕ\nhb₁ : ∀ {i : ℕ}, i ∈ Quotient.mk (List.isSetoid ℕ) b → 0 < i\nhb₂ : sum (Quotient.mk (List.isSetoid ℕ) b) = n\n⊢ ∃ a, ofComposition n a = { parts := Quotient.mk (List.isSetoid ℕ) b, parts_pos := hb₁, parts_sum := hb₂ }"],"content":"rcases Quotient.exists_rep b with ⟨b, rfl⟩"},{"tailPos":2678,"headPos":2607,"goalsBefore":["case mk.intro\nα : Type ?u.1285\nn : ℕ\nb : List ℕ\nhb₁ : ∀ {i : ℕ}, i ∈ Quotient.mk (List.isSetoid ℕ) b → 0 < i\nhb₂ : sum (Quotient.mk (List.isSetoid ℕ) b) = n\n⊢ ∃ a, ofComposition n a = { parts := Quotient.mk (List.isSetoid ℕ) b, parts_pos := hb₁, parts_sum := hb₂ }"],"goalsAfter":["case mk.intro\nα : Type ?u.1285\nn : ℕ\nb : List ℕ\nhb₁ : ∀ {i : ℕ}, i ∈ Quotient.mk (List.isSetoid ℕ) b → 0 < i\nhb₂ : sum (Quotient.mk (List.isSetoid ℕ) b) = n\n⊢ List.sum b = n"],"content":"refine' ⟨⟨b, fun {i} hi => hb₁ hi, _⟩, Partition.ext _ _ rfl⟩"},{"tailPos":2698,"headPos":2681,"goalsBefore":["case mk.intro\nα : Type ?u.1285\nn : ℕ\nb : List ℕ\nhb₁ : ∀ {i : ℕ}, i ∈ Quotient.mk (List.isSetoid ℕ) b → 0 < i\nhb₂ : sum (Quotient.mk (List.isSetoid ℕ) b) = n\n⊢ List.sum b = n"],"goalsAfter":[],"content":"simpa only [quot_mk_to_coe, coe_sum] using hb₂"},{"tailPos":2698,"headPos":2527,"goalsBefore":["α : Type ?u.1285\nn : ℕ\n⊢ Function.Surjective (ofComposition n)"],"goalsAfter":[],"content":"rintro ⟨b, hb₁, hb₂⟩\n  rcases Quotient.exists_rep b with ⟨b, rfl⟩\n  refine' ⟨⟨b, fun {i} hi => hb₁ hi, _⟩, Partition.ext _ _ rfl⟩\n  simpa using hb₂"},{"tailPos":2524,"headPos":2522,"goalsBefore":["α : Type ?u.1285\nn : ℕ\n⊢ Function.Surjective (ofComposition n)"],"goalsAfter":[],"content":"by"},{"tailPos":2698,"headPos":2522,"goalsBefore":["α : Type ?u.1285\nn : ℕ\n⊢ Function.Surjective (ofComposition n)"],"goalsAfter":[],"content":"by\n  rintro ⟨b, hb₁, hb₂⟩\n  rcases Quotient.exists_rep b with ⟨b, rfl⟩\n  refine' ⟨⟨b, fun {i} hi => hb₁ hi, _⟩, Partition.ext _ _ rfl⟩\n  simpa using hb₂"},{"tailPos":3206,"headPos":3184,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\ni : ℕ\nhi : i ∈ filter (fun x => x ≠ 0) l\n⊢ i ≠ 0"],"goalsAfter":[],"content":"apply of_mem_filter hi"},{"tailPos":3183,"headPos":3181,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\ni : ℕ\nhi : i ∈ filter (fun x => x ≠ 0) l\n⊢ i ≠ 0"],"goalsAfter":[],"content":"by"},{"tailPos":3206,"headPos":3181,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\ni : ℕ\nhi : i ∈ filter (fun x => x ≠ 0) l\n⊢ i ≠ 0"],"goalsAfter":[],"content":"by apply of_mem_filter hi"},{"tailPos":3304,"headPos":3229,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l = l\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"content":"have lt : l.filter (· = 0) + l.filter (· ≠ 0) = l := filter_add_not _ l"},{"tailPos":3338,"headPos":3309,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l = l\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"content":"apply_fun Multiset.sum  at lt"},{"tailPos":3421,"headPos":3397,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ sum (filter (fun x => x = 0) l) = 0"],"goalsAfter":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ ∀ (x : ℕ), x ∈ filter (fun x => x = 0) l → x = 0"],"content":"Multiset.sum_eq_zero_iff"},{"tailPos":3422,"headPos":3421,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ ∀ (x : ℕ), x ∈ filter (fun x => x = 0) l → x = 0"],"goalsAfter":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ ∀ (x : ℕ), x ∈ filter (fun x => x = 0) l → x = 0"],"content":"]"},{"tailPos":3422,"headPos":3393,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ sum (filter (fun x => x = 0) l) = 0"],"goalsAfter":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ ∀ (x : ℕ), x ∈ filter (fun x => x = 0) l → x = 0"],"content":"rw [Multiset.sum_eq_zero_iff]"},{"tailPos":3433,"headPos":3429,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ ∀ (x : ℕ), x ∈ filter (fun x => x = 0) l → x = 0"],"goalsAfter":[],"content":"simp only [mem_filter, and_imp, imp_self, implies_true, forall_const]"},{"tailPos":3433,"headPos":3393,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ sum (filter (fun x => x = 0) l) = 0"],"goalsAfter":[],"content":"rw [Multiset.sum_eq_zero_iff]\n      simp"},{"tailPos":3386,"headPos":3384,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ sum (filter (fun x => x = 0) l) = 0"],"goalsAfter":[],"content":"by"},{"tailPos":3433,"headPos":3384,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ sum (filter (fun x => x = 0) l) = 0"],"goalsAfter":[],"content":"by\n      rw [Multiset.sum_eq_zero_iff]\n      simp"},{"tailPos":3433,"headPos":3343,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"content":"have lz : (l.filter (· = 0)).sum = 0 := by\n      rw [Multiset.sum_eq_zero_iff]\n      simp"},{"tailPos":3509,"headPos":3443,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l) + sum (filter (fun x => ¬x = 0) l) = sum l\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"content":"sum_add (filter (fun x => x = 0) l) (filter (fun x => ¬x = 0) l),"},{"tailPos":3512,"headPos":3509,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l) + sum (filter (fun x => ¬x = 0) l) = sum l\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : 0 + sum (filter (fun x => ¬x = 0) l) = sum l\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"content":"lz,"},{"tailPos":3515,"headPos":3512,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : 0 + sum (filter (fun x => ¬x = 0) l) = sum l\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : 0 + sum (filter (fun x => ¬x = 0) l) = n\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"content":"hl,"},{"tailPos":3524,"headPos":3516,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : 0 + sum (filter (fun x => ¬x = 0) l) = n\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => ¬x = 0) l) = n\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"content":"zero_add"},{"tailPos":3525,"headPos":3524,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => ¬x = 0) l) = n\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => ¬x = 0) l) = n\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"content":"]"},{"tailPos":3531,"headPos":3438,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\nlt : sum (filter (fun x => x = 0) l + filter (fun x => x ≠ 0) l) = sum l\nlz : sum (filter (fun x => x = 0) l) = 0\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":[],"content":"rwa [sum_add (filter (fun x => x = 0) l) (filter (fun x => ¬x = 0) l),lz,hl, zero_add] at lt"},{"tailPos":3531,"headPos":3229,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":[],"content":"have lt : l.filter (· = 0) + l.filter (· ≠ 0) = l := filter_add_not _ l\n    apply_fun Multiset.sum  at lt\n    have lz : (l.filter (· = 0)).sum = 0 := by\n      rw [Multiset.sum_eq_zero_iff]\n      simp\n    rwa [sum_add (filter (fun x => x = 0) l) (filter (fun x => ¬x = 0) l),lz,hl, zero_add] at lt"},{"tailPos":3224,"headPos":3222,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":[],"content":"by"},{"tailPos":3531,"headPos":3222,"goalsBefore":["α : Type ?u.1672\nn : ℕ\nl : Multiset ℕ\nhl : sum l = n\n⊢ sum (filter (fun x => x ≠ 0) l) = n"],"goalsAfter":[],"content":"by\n    have lt : l.filter (· = 0) + l.filter (· ≠ 0) = l := filter_add_not _ l\n    apply_fun Multiset.sum  at lt\n    have lz : (l.filter (· = 0)).sum = 0 := by\n      rw [Multiset.sum_eq_zero_iff]\n      simp\n    rwa [sum_add (filter (fun x => x = 0) l) (filter (fun x => ¬x = 0) l),lz,hl, zero_add] at lt"}]